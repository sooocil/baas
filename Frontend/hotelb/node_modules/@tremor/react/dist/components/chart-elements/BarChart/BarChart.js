'use client';
import{__rest as e}from"tslib";import{BaseColors as t}from"../../../lib/constants.js";import{themeColorRange as a,colorPalette as l}from"../../../lib/theme.js";import{tremorTwMerge as i}from"../../../lib/tremorTwMerge.js";import{getColorClassNames as o,defaultValueFormatter as r}from"../../../lib/utils.js";import n,{useState as s}from"react";import{ResponsiveContainer as c,BarChart as m,CartesianGrid as d,XAxis as v,YAxis as u,Tooltip as p,Legend as h,Bar as y}from"recharts";import g from"../common/ChartLegend.js";import f from"../common/ChartTooltip.js";import k from"../common/NoData.js";import{constructCategoryColors as b,deepEqual as x,getYAxisDomain as w}from"../common/utils.js";const E=n.forwardRef(((E,j)=>{const{data:L=[],categories:A=[],index:T,colors:O=a,valueFormatter:C=r,layout:N="horizontal",stack:D=!1,relative:S=!1,startEndOnly:G=!1,animationDuration:V=900,showAnimation:F=!1,showXAxis:K=!0,showYAxis:M=!0,yAxisWidth:z=56,intervalType:P="equidistantPreserveStart",showTooltip:X=!0,showLegend:B=!0,showGridLines:H=!0,autoMinValue:W=!1,minValue:Y,maxValue:q,allowDecimals:I=!0,noDataText:R,onValueChange:$,enableLegendSlider:J=!1,customTooltip:Q,rotateLabelX:U,tickGap:Z=5,className:_}=E,ee=e(E,["data","categories","index","colors","valueFormatter","layout","stack","relative","startEndOnly","animationDuration","showAnimation","showXAxis","showYAxis","yAxisWidth","intervalType","showTooltip","showLegend","showGridLines","autoMinValue","minValue","maxValue","allowDecimals","noDataText","onValueChange","enableLegendSlider","customTooltip","rotateLabelX","tickGap","className"]),te=Q,ae=K||M?20:0,[le,ie]=s(60),oe=b(A,O),[re,ne]=n.useState(void 0),[se,ce]=s(void 0),me=!!$;function de(e,t,a){var l,i,o,r;a.stopPropagation(),$&&(x(re,Object.assign(Object.assign({},e.payload),{value:e.value}))?(ce(void 0),ne(void 0),null==$||$(null)):(ce(null===(i=null===(l=e.tooltipPayload)||void 0===l?void 0:l[0])||void 0===i?void 0:i.dataKey),ne(Object.assign(Object.assign({},e.payload),{value:e.value})),null==$||$(Object.assign({eventType:"bar",categoryClicked:null===(r=null===(o=e.tooltipPayload)||void 0===o?void 0:o[0])||void 0===r?void 0:r.dataKey},e.payload))))}const ve=w(W,Y,q);return n.createElement("div",Object.assign({ref:j,className:i("w-full h-80",_)},ee),n.createElement(c,{className:"h-full w-full"},(null==L?void 0:L.length)?n.createElement(m,{data:L,stackOffset:D?"sign":S?"expand":"none",layout:"vertical"===N?"vertical":"horizontal",onClick:me&&(se||re)?()=>{ne(void 0),ce(void 0),null==$||$(null)}:void 0},H?n.createElement(d,{className:i("stroke-1","stroke-tremor-border","dark:stroke-dark-tremor-border"),horizontal:"vertical"!==N,vertical:"vertical"===N}):null,"vertical"!==N?n.createElement(v,{padding:{left:ae,right:ae},hide:!K,dataKey:T,interval:G?"preserveStartEnd":P,tick:{transform:"translate(0, 6)"},ticks:G?[L[0][T],L[L.length-1][T]]:void 0,fill:"",stroke:"",className:i("mt-4 text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,angle:null==U?void 0:U.angle,dy:null==U?void 0:U.verticalShift,height:null==U?void 0:U.xAxisHeight,minTickGap:Z}):n.createElement(v,{hide:!K,type:"number",tick:{transform:"translate(-3, 0)"},domain:ve,fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,tickFormatter:C,minTickGap:Z,allowDecimals:I,angle:null==U?void 0:U.angle,dy:null==U?void 0:U.verticalShift,height:null==U?void 0:U.xAxisHeight}),"vertical"!==N?n.createElement(u,{width:z,hide:!M,axisLine:!1,tickLine:!1,type:"number",domain:ve,tick:{transform:"translate(-3, 0)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickFormatter:S?e=>`${(100*e).toString()} %`:C,allowDecimals:I}):n.createElement(u,{width:z,hide:!M,dataKey:T,axisLine:!1,tickLine:!1,ticks:G?[L[0][T],L[L.length-1][T]]:void 0,type:"category",interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content")}),n.createElement(p,{wrapperStyle:{outline:"none"},isAnimationActive:!1,cursor:{fill:"#d1d5db",opacity:"0.15"},content:X?({active:e,payload:a,label:l})=>te?n.createElement(te,{payload:null==a?void 0:a.map((e=>{var a;return Object.assign(Object.assign({},e),{color:null!==(a=oe.get(e.dataKey))&&void 0!==a?a:t.Gray})})),active:e,label:l}):n.createElement(f,{active:e,payload:a,label:l,valueFormatter:C,categoryColors:oe}):n.createElement(n.Fragment,null),position:{y:0}}),B?n.createElement(h,{verticalAlign:"top",height:le,content:({payload:e})=>g({payload:e},oe,ie,se,me?e=>{return t=e,void(me&&(t!==se||re?(ce(t),null==$||$({eventType:"category",categoryClicked:t})):(ce(void 0),null==$||$(null)),ne(void 0)));var t}:void 0,J)}):null,A.map((e=>{var a;return n.createElement(y,{className:i(o(null!==(a=oe.get(e))&&void 0!==a?a:t.Gray,l.background).fillColor,$?"cursor-pointer":""),key:e,name:e,type:"linear",stackId:D||S?"a":void 0,dataKey:e,fill:"",isAnimationActive:F,animationDuration:V,shape:e=>((e,t,a,l)=>{const{fillOpacity:i,name:o,payload:r,value:s}=e;let{x:c,width:m,y:d,height:v}=e;return"horizontal"===l&&v<0?(d+=v,v=Math.abs(v)):"vertical"===l&&m<0&&(c+=m,m=Math.abs(m)),n.createElement("rect",{x:c,y:d,width:m,height:v,opacity:t||a&&a!==o?x(t,Object.assign(Object.assign({},r),{value:s}))?i:.3:i})})(e,re,se,N),onClick:de})}))):n.createElement(k,{noDataText:R})))}));E.displayName="BarChart";export{E as default};
